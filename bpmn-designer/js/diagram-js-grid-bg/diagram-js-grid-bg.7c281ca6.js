var t=function(){return t=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},t.apply(this,arguments)};function i(t,i){return function(t,i){i.appendChild(function(t,i){if(t.ownerDocument!==i.ownerDocument)try{return i.ownerDocument.importNode(t,!0)}catch(n){}return t}(t,i))}(i,t),t}var n=2,r={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":n,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":n,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function e(t,i,e){var o=i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),a=r[o];a?(a===n&&"number"==typeof e&&(e=String(e)+"px"),t.style[o]=e):t.setAttributeNS(null,i,e)}function o(t,i,n){if("string"==typeof i){if(void 0===n)return function(t,i){return r[i]?t.style[i]:t.getAttributeNS(null,i)}(t,i);e(t,i,n)}else!function(t,i){var n,r,o=Object.keys(i);for(n=0;r=o[n];n++)e(t,r,i[r])}(t,i);return t}function a(t){var i=t.parentNode;return i&&i.removeChild(t),t}var c,s={svg:"http://www.w3.org/2000/svg"},g='<svg xmlns="'+s.svg+'"';function l(t){var i=!1;"<svg"===t.substring(0,4)?-1===t.indexOf(s.svg)&&(t=g+t.substring(4)):(t=g+">"+t+"</svg>",i=!0);var n=function(t){var i;return(i=new DOMParser).async=!1,i.parseFromString(t,"text/xml")}(t);if(!i)return n;for(var r=document.createDocumentFragment(),e=n.firstChild;e.firstChild;)r.appendChild(e.firstChild);return r}function d(t,i){var n;return"<"===t.charAt(0)?(n=l(t).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(s.svg,t),i&&o(n,i),n}"undefined"!=typeof document&&((c=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',c.getElementsByTagName("link").length,c=void 0);function f(t,i,n){return n||(n="round"),Math[n](t/i)*i}const h=Object.prototype.toString,p=Object.prototype.hasOwnProperty;function u(t){return r=t,"[object Object]"===h.call(r)&&(i=t,n="waypoints",p.call(i,n));var i,n,r}function v(t){return i={x:t.x+(t.width||0)/2,y:t.y+(t.height||0)/2},{x:Math.round(i.x),y:Math.round(i.y)};var i}function y(t){for(var i=t.waypoints,n=i.reduce((function(t,n,r){var e,o,a=i[r-1];if(a){var c=t[t.length-1],s=c&&c.endLength||0,g=(e=a,o=n,Math.sqrt(Math.pow(e.x-o.x,2)+Math.pow(e.y-o.y,2)));t.push({start:a,end:n,startLength:s,endLength:s+g,length:g})}return t}),[]),r=n.reduce((function(t,i){return t+i.length}),0)/2,e=0,o=n[e];o.endLength<r;)o=n[++e];var a=(r-o.startLength)/o.length;return{x:o.start.x+(o.end.x-o.start.x)*a,y:o.start.y+(o.end.y-o.start.y)*a}}var _=1e5,m=1e5,b=function(){function n(i,n,r){var e=this;this._config=t({smallGridSpacing:10,gridSpacing:100,gridLineStroke:.5,gridLineOpacity:.4,gridLineColor:"#ccc"},i||{}),this._canvas=n,this._visible=!1,r.on("diagram.init",(function(){e._init()})),r.on("gridSnapping.toggle",(function(t){var i=t.active;e.toggle(i),e._centerGridAroundViewbox()})),r.on("canvas.viewbox.changed",(function(t){var i=t.viewbox;e._centerGridAroundViewbox(i)}))}return n.prototype._init=function(){var t,n=(t="defs",(this._canvas._svg||document).querySelector(t));n||(n=d("defs"),i(this._canvas._svg,n));var r=d("pattern"),e="djs-small-grid-pattern-"+x();o(r,{id:e,width:this._config.smallGridSpacing,height:this._config.smallGridSpacing,patternUnits:"userSpaceOnUse"});var a=d("path");o(a,{d:"M ".concat(this._config.smallGridSpacing," 0 L 0 0 0 ").concat(this._config.smallGridSpacing),fill:"none",stroke:this._config.gridLineColor,strokeWidth:this._config.gridLineStroke,opacity:this._config.gridLineOpacity}),i(r,a);var c=this._pattern=d("pattern"),s="djs-grid-pattern-"+x();o(c,{id:s,width:this._config.gridSpacing,height:this._config.gridSpacing,patternUnits:"userSpaceOnUse"});var g=d("path");o(g,{d:"M ".concat(this._config.gridSpacing," 0 L 0 0 0 ").concat(this._config.gridSpacing),fill:"none",stroke:this._config.gridLineColor,strokeWidth:2*this._config.gridLineStroke,opacity:2*this._config.gridLineOpacity}),i(c,g);var l=d("rect");o(l,{width:this._config.gridSpacing,height:this._config.gridSpacing,fill:"url(#".concat(e,")")}),i(c,l),i(n,r),i(n,c),o(this._gfx=d("rect"),{x:-_/2,y:-m/2,width:_,height:m,fill:"url(#".concat(s,")")})},n.prototype._centerGridAroundViewbox=function(t){t||(t=this._canvas.viewbox());var i,n=u(i=t)?y(i):v(i);o(this._gfx,{x:-_/2+f(n.x,this._config.gridSpacing,"round"),y:-m/2+f(n.y,this._config.gridSpacing,"round")})},n.prototype.isVisible=function(){return this._visible},n.prototype.toggle=function(t){if(void 0===t&&(t=!this._visible),t!==this._visible){var n=this._getParent();t?i(n,this._gfx):function(t){for(var i;i=t.firstChild;)a(i)}(n),this._visible=t}},n.prototype._getParent=function(){return this._canvas.getLayer("djs-grid-line",-2)},n}();function x(){return Math.round(1e6*Math.random())}b.$inject=["config.gridLine","canvas","eventBus"];var w={__init__:["gridLineBg"],gridLineBg:["type",b]};export{w as g};
