import{a as t,t as e,k as i}from"../min-dash/min-dash.ed2edcc5.js";import{a as n,c as o,e as r,d as a,q as s,f as p,h as c}from"../min-dom/min-dom.04e3f566.js";var d=function(){return d=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},d.apply(this,arguments)};function l(t){return CSS.escape(t)}var u=".entry",h="djs-accordion-palette",g="open",f=function(){function i(t,e,i,n){var o=this;this._config=d({},t||{}),this._canvas=e,this._eventBus=i,this._translate=n,i.on("tool-manager.update",(function(t){var e=t.tool;o.updateToolHighlight(e)})),i.on("i18n.changed",(function(){o._update()})),i.on("diagram.init",(function(){o._diagramInitialized=!0,o._rebuild()}))}return i.prototype.registerProvider=function(t,e){e||(e=t,t=1e3),this._eventBus.on("palette.getProviders",t,(function(t){t.providers.push(e)})),this._rebuild()},i.prototype.getEntries=function(){return this._getProviders().reduce(_,{})},i.prototype._rebuild=function(){this._diagramInitialized&&(this._getProviders().length&&(this._container||this._init(),this._update()))},i.prototype._init=function(){var t=this,e=this._eventBus,s=this._getParentContainer(),p=this._container=n(i.HTML_MARKUP);s.appendChild(p),o(s).add(h+"shown"),r.bind(p,"mousedown",(function(t){t.stopPropagation()})),a.bind(p,u,"click",(function(e){t.trigger("click",e)})),a.bind(p,u,"dragstart",(function(e){t.trigger("dragstart",e)})),r.bind(p,"mousewheel",(function(t){t.stopPropagation(),t.stopImmediatePropagation()})),r.bind(p,"wheel",(function(t){t.stopPropagation(),t.stopImmediatePropagation()})),e.fire("palette.create",{container:p})},i.prototype._getProviders=function(){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers},i.prototype.toggleState=function(t){void 0===t&&(t={});var e=this._eventBus;"showName"in t&&(this._config.showName=t.showName),"accordion"in t&&(this._config.accordion=t.accordion),"defaultOpenGroups"in t&&(this._config.defaultOpenGroups=t.defaultOpenGroups),this.isOpen()&&(this.close(),this._update()),e.fire("palette.changed",d({open:this.isOpen()},this._config))},i.prototype._update=function(){var e=this._translate,i=s(".djs-palette-entries",this._container),r=this._entries=this.getEntries(),a=!!this._config.accordion,d=!!this._config.showName,u=this._config.defaultOpenGroups||[],h=u.reduce((function(t,e){return(t[e]=!0)&&t}),{});p(i),a&&u.length,t(r,(function(t,r){if(!t.separator){var p=l(a?"accordion-group":t.group||"default"),u=l(t.group||"default"),g=s("[data-group-details=".concat(u,"]"),i);if(!g){g=n('<details class="djs-accordion-group" name="'.concat(p,'"></details>')),c(g,"data-group-details",u),i.appendChild(g);var f=n("<summary>".concat(e(t.group||"default"),"</summary>"));g.appendChild(f)}h[t.group]&&c(g,"open","true");var _=s("[data-group=".concat(u,"]"),g);_||(_=n('<div class="djs-palette-group"></div>'),c(_,"data-group",u),g.appendChild(_));var y,m=t.html||'<div class="entry" draggable="true"></div>',P=n(m);if(d){var C=n('<div class="djs-entry-item djs-entry-with-name"></div>');_.appendChild(C),C.appendChild(P),y=C}else _.appendChild(P),y=P;if(c(P,"data-action",r),o(P).has("entry")||v(P,"entry"),t.title&&(c(y,"title",t.title),d)){var j=n('<div class="djs-entry-title">'.concat(t.title,"</div>"));y.appendChild(j)}if(t.className&&v(P,t.className),t.imageUrl){var b=n('<img class="djs-entry-img">');c(b,"src",t.imageUrl),y.appendChild(b)}}})),this.open()},i.prototype.trigger=function(t,e,i){var n,o,r=e.delegateTarget||e.target;return r?(n=c(r,"data-action"),o=e.originalEvent||e,this.triggerEntry(n,t,o,i)):e.preventDefault()},i.prototype.triggerEntry=function(t,i,n,o){var r,a;if((r=this._entries[t])&&(a=r.action,!1!==this._eventBus.fire("palette.trigger",{entry:r,event:n}))){if(e(a)){if("click"===i)return a(n,o)}else if(a[i])return a[i](n,o);n.preventDefault()}},i.prototype._needsCollapse=function(t,e){return t<46*Object.keys(e).length+50},i.prototype.close=function(){this._toggleVisible(!1)},i.prototype.open=function(){this._toggleVisible(!0)},i.prototype.toggle=function(){this.isOpen()?this.close():this.open()},i.prototype._toggleVisible=function(t){var e=this._eventBus,i=this._getParentContainer(),n=this._container,r=o(n),a=o(i);r.toggle(g,t),a.toggle(h+g,t),e.fire("palette.changed",{open:this.isOpen()})},i.prototype.isActiveTool=function(t){return t&&this._activeTool===t},i.prototype.updateToolHighlight=function(e){var i,n;this._toolsContainer||(i=s(".djs-palette-entries",this._container),this._toolsContainer=s("[data-group=tools]",i)),n=this._toolsContainer,t(n.children,(function(t){var i=t.getAttribute("data-action");if(i){var n=o(t);i=i.replace("-tool",""),n.contains("entry")&&i===e?n.add("highlighted-entry"):n.remove("highlighted-entry")}}))},i.prototype.isOpen=function(){return o(this._container).has(g)},i.prototype._getParentContainer=function(){return this._canvas.getContainer()},i.HTML_MARKUP='<div class="djs-accordion-palette"><div class="djs-palette-entries"></div></div>',i}();function v(t,e){var n=o(t);(i(e)?e:e.split(/\s+/g)).forEach((function(t){return n.add(t)}))}function _(i,n){var o=n.getPaletteEntries();return e(o)?o(i):(t(o,(function(t,e){i[e]=t})),i)}f.$inject=["config.accordionPalette","canvas","eventBus","translate"];var y={__init__:["palette"],palette:["type",f]};export{y as a};
