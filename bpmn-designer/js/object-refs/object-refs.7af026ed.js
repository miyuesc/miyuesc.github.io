function e(e,n,t){var r=function(e,n,t,r){var i=t.inverse;return Object.defineProperty(e,"remove",{value:function(e){var t=this.indexOf(e);return-1!==t&&(this.splice(t,1),n.unset(e,i,r)),e}}),Object.defineProperty(e,"contains",{value:function(e){return-1!==this.indexOf(e)}}),Object.defineProperty(e,"add",{value:function(e,t){var o=this.indexOf(e);if(void 0===t){if(-1!==o)return;t=this.length}-1!==o&&this.splice(o,1),this.splice(t,0,e),-1===o&&n.set(e,i,r)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e}(t[n.name]||[],e,n,t);Object.defineProperty(t,n.name,{enumerable:n.enumerable,value:r}),r.length&&r.forEach((function(r){e.set(r,n.inverse,t)}))}function n(e,t){if(!(this instanceof n))return new n(e,t);e.inverse=t,t.inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}n.prototype.bind=function(n,t){if("string"==typeof t){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}t.collection?e(this,t,n):function(e,n,t){var r=n.inverse,i=t[n.name];Object.defineProperty(t,n.name,{configurable:n.configurable,enumerable:n.enumerable,get:function(){return i},set:function(n){if(n!==i){var o=i;i=null,o&&e.unset(o,r,t),i=n,e.set(i,r,t)}}})}(this,t,n)},n.prototype.ensureRefsCollection=function(n,t){var r=n[t.name];return function(e){return!0===e.__refs_collection}(r)||e(this,t,n),r},n.prototype.ensureBound=function(e,n){(function(e,n){return Object.prototype.hasOwnProperty.call(e,n.name||n)})(e,n)||this.bind(e,n)},n.prototype.unset=function(e,n,t){e&&(this.ensureBound(e,n),n.collection?this.ensureRefsCollection(e,n).remove(t):e[n.name]=void 0)},n.prototype.set=function(e,n,t){e&&(this.ensureBound(e,n),n.collection?this.ensureRefsCollection(e,n).add(t):e[n.name]=t)};export{n as R};
