var r=/,?([a-z]),?/gi,e=parseFloat,t=Math,n=t.PI,i=t.min,a=t.max,o=t.pow,u=t.abs,c=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,s=/(-?\d*\.?\d*(?:e[-+]?\d+)?)[\s]*,?[\s]*/gi,x=Array.isArray||function(r){return r instanceof Array};function f(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function y(r){if("function"==typeof r||Object(r)!==r)return r;var e=new r.constructor;for(var t in r)f(r,t)&&(e[t]=y(r[t]));return e}function l(r){var e=l.ps=l.ps||{};return e[r]?e[r].sleep=100:e[r]={sleep:100},setTimeout((function(){for(var t in e)f(e,t)&&t!=r&&(e[t].sleep--,!e[t].sleep&&delete e[t])})),e[r]}function h(r,e,t,n){return 1===arguments.length&&(e=r.y,t=r.width,n=r.height,r=r.x),{x:r,y:e,width:t,height:n,x2:r+t,y2:e+n}}function v(){return this.join(",").replace(r,"$1")}function p(r){var e=y(r);return e.toString=v,e}function g(r,e,t,n,i,a,u,c,s){var x=1-s,f=o(x,3),y=o(x,2),l=s*s*s,h=f*e+3*y*s*n+3*x*s*s*a+l*c;return{x:k(f*r+3*y*s*t+3*x*s*s*i+l*u),y:k(h)}}function b(r){var e=function(r,e,n,o,c,s,x,f){for(var y,l,h,v,p,g,b,d,C=[],q=[[],[]],F=0;F<2;++F)if(0==F?(l=6*r-12*n+6*c,y=-3*r+9*n-9*c+3*x,h=3*n-3*r):(l=6*e-12*o+6*s,y=-3*e+9*o-9*s+3*f,h=3*o-3*e),u(y)<1e-12){if(u(l)<1e-12)continue;0<(v=-h/l)&&v<1&&C.push(v)}else b=l*l-4*h*y,d=t.sqrt(b),b<0||(0<(p=(-l+d)/(2*y))&&p<1&&C.push(p),0<(g=(-l-d)/(2*y))&&g<1&&C.push(g));var k,w=C.length,M=w;for(;w--;)k=1-(v=C[w]),q[0][w]=k*k*k*r+3*k*k*v*n+3*k*v*v*c+v*v*v*x,q[1][w]=k*k*k*e+3*k*k*v*o+3*k*v*v*s+v*v*v*f;return q[0][M]=r,q[1][M]=e,q[0][M+1]=x,q[1][M+1]=f,q[0].length=q[1].length=M+2,{x0:i(...q[0]),y0:i(...q[1]),x1:a(...q[0]),y1:a(...q[1])}}(...r);return h(e.x0,e.y0,e.x1-e.x0,e.y1-e.y0)}function d(r,e,t){return e>=r.x&&e<=r.x+r.width&&t>=r.y&&t<=r.y+r.height}function C(r,e,t,n,i){return r*(r*(-3*e+9*t-9*n+3*i)+6*e-12*t+6*n)-3*e+3*t}function q(r,e,n,i,a,o,u,c,s){null==s&&(s=1);for(var x=(s=s>1?1:s<0?0:s)/2,f=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],y=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],l=0,h=0;h<12;h++){var v=x*f[h]+x,p=C(v,r,n,a,u),g=C(v,e,i,o,c),b=p*p+g*g;l+=y[h]*t.sqrt(b)}return x*l}function F(r,e,t,n,o,u,c,s){if(!(a(r,t)<i(o,c)||i(r,t)>a(o,c)||a(e,n)<i(u,s)||i(e,n)>a(u,s))){var x=(r*n-e*t)*(u-s)-(e-n)*(o*s-u*c),f=(r-t)*(u-s)-(e-n)*(o-c);if(f){var y=k(((r*n-e*t)*(o-c)-(r-t)*(o*s-u*c))/f),l=k(x/f),h=+y.toFixed(2),v=+l.toFixed(2);if(!(h<+i(r,t).toFixed(2)||h>+a(r,t).toFixed(2)||h<+i(o,c).toFixed(2)||h>+a(o,c).toFixed(2)||v<+i(e,n).toFixed(2)||v>+a(e,n).toFixed(2)||v<+i(u,s).toFixed(2)||v>+a(u,s).toFixed(2)))return{x:y,y:l}}}}function k(r){return Math.round(1e11*r)/1e11}function w(r,e,t){if(!function(r,e){return r=h(r),d(e=h(e),r.x,r.y)||d(e,r.x2,r.y)||d(e,r.x,r.y2)||d(e,r.x2,r.y2)||d(r,e.x,e.y)||d(r,e.x2,e.y)||d(r,e.x,e.y2)||d(r,e.x2,e.y2)||(r.x<e.x2&&r.x>e.x||e.x<r.x2&&e.x>r.x)&&(r.y<e.y2&&r.y>e.y||e.y<r.y2&&e.y>r.y)}(b(r),b(e)))return t?0:[];for(var n=q(...r),i=q(...e),a=A(r)?1:~~(n/5)||1,o=A(e)?1:~~(i/5)||1,c=[],s=[],x={},f=t?0:[],y=0;y<a+1;y++){var l=g(...r,y/a);c.push({x:l.x,y:l.y,t:y/a})}for(y=0;y<o+1;y++)l=g(...e,y/o),s.push({x:l.x,y:l.y,t:y/o});for(y=0;y<a;y++)for(var v=0;v<o;v++){var p,C=c[y],k=c[y+1],w=s[v],M=s[v+1],m=u(k.x-C.x)<.01?"y":"x",S=u(M.x-w.x)<.01?"y":"x",j=F(C.x,C.y,k.x,k.y,w.x,w.y,M.x,M.y);if(j){if(x[p=j.x.toFixed(9)+"#"+j.y.toFixed(9)])continue;x[p]=!0;var z=C.t+u((j[m]-C[m])/(k[m]-C[m]))*(k.t-C.t),T=w.t+u((j[S]-w[S])/(M[S]-w[S]))*(M.t-w.t);z>=0&&z<=1&&T>=0&&T<=1&&(t?f++:f.push({x:j.x,y:j.y,t1:z,t2:T}))}}return f}function M(r,e,t){r=T(r),e=T(e);for(var n,i,a,o,u,c,s,x,f,y,l=t?0:[],h=0,v=r.length;h<v;h++){var p=r[h];if("M"==p[0])n=u=p[1],i=c=p[2];else{"C"==p[0]?(n=(f=[n,i,...p.slice(1)])[6],i=f[7]):(f=[n,i,n,i,u,c,u,c],n=u,i=c);for(var g=0,b=e.length;g<b;g++){var d=e[g];if("M"==d[0])a=s=d[1],o=x=d[2];else{"C"==d[0]?(a=(y=[a,o,...d.slice(1)])[6],o=y[7]):(y=[a,o,a,o,s,x,s,x],a=s,o=x);var C=w(f,y,t);if(t)l+=C;else{for(var q=0,F=C.length;q<F;q++)C[q].segment1=h,C[q].segment2=g,C[q].bez1=f,C[q].bez2=y;l=l.concat(C)}}}}}return l}function m(r){var e=l(r);if(e.abs)return p(e.abs);if(x(r)&&x(r&&r[0])||(r=function(r){if(!r)return null;var e=l(r);if(e.arr)return y(e.arr);var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=[];return x(r)&&x(r[0])&&(n=y(r)),n.length||String(r).replace(c,(function(r,e,i){var a=[],o=e.toLowerCase();for(i.replace(s,(function(r,e){e&&a.push(+e)})),"m"==o&&a.length>2&&(n.push([e,...a.splice(0,2)]),o="l",e="m"==e?"l":"L");a.length>=t[o]&&(n.push([e,...a.splice(0,t[o])]),t[o]););})),n.toString=l.toString,e.arr=y(n),n}(r)),!r||!r.length)return[["M",0,0]];var t,n=[],i=0,a=0,o=0,u=0,f=0;"M"==r[0][0]&&(o=i=+r[0][1],u=a=+r[0][2],f++,n[0]=["M",i,a]);for(var h,g,b=f,d=r.length;b<d;b++){if(n.push(h=[]),(t=(g=r[b])[0])!=t.toUpperCase())switch(h[0]=t.toUpperCase(),h[0]){case"A":h[1]=g[1],h[2]=g[2],h[3]=g[3],h[4]=g[4],h[5]=g[5],h[6]=+g[6]+i,h[7]=+g[7]+a;break;case"V":h[1]=+g[1]+a;break;case"H":h[1]=+g[1]+i;break;case"M":o=+g[1]+i,u=+g[2]+a;default:for(var C=1,q=g.length;C<q;C++)h[C]=+g[C]+(C%2?i:a)}else for(var F=0,k=g.length;F<k;F++)h[F]=g[F];switch(t=t.toUpperCase(),h[0]){case"Z":i=+o,a=+u;break;case"H":i=h[1];break;case"V":a=h[1];break;case"M":o=h[h.length-2],u=h[h.length-1];default:i=h[h.length-2],a=h[h.length-1]}}return n.toString=v,e.abs=p(n),n}function A(r){return r[0]===r[2]&&r[1]===r[3]&&r[4]===r[6]&&r[5]===r[7]}function S(r,e,t,n){return[r,e,t,n,t,n]}function j(r,e,t,n,i,a){var o=1/3,u=2/3;return[o*r+u*t,o*e+u*n,o*i+u*t,o*a+u*n,i,a]}function z(r,e,i,a,o,c,s,x,y,l){var h,v,p=120*n/180,g=n/180*(+o||0),b=[],d=(v=function(r,e,n){return{x:r*t.cos(n)-e*t.sin(n),y:r*t.sin(n)+e*t.cos(n)}},function r(){var e=Array.prototype.slice.call(arguments,0).join("␀"),t=r.cache=r.cache||{},n=r.count=r.count||[];return f(t,e)?(function(r,e){for(var t=0,n=r.length;t<n;t++)if(r[t]===e)return r.push(r.splice(t,1)[0])}(n,e),t[e]):(n.length>=1e3&&delete t[n.shift()],n.push(e),t[e]=v(...arguments),t[e])});if(l)S=l[0],j=l[1],m=l[2],A=l[3];else{r=(h=d(r,e,-g)).x,e=h.y;var C=(r-(x=(h=d(x,y,-g)).x))/2,q=(e-(y=h.y))/2,F=C*C/(i*i)+q*q/(a*a);F>1&&(i*=F=t.sqrt(F),a*=F);var k=i*i,w=a*a,M=(c==s?-1:1)*t.sqrt(u((k*w-k*q*q-w*C*C)/(k*q*q+w*C*C))),m=M*i*q/a+(r+x)/2,A=M*-a*C/i+(e+y)/2,S=t.asin(((e-A)/a).toFixed(9)),j=t.asin(((y-A)/a).toFixed(9));(S=r<m?n-S:S)<0&&(S=2*n+S),(j=x<m?n-j:j)<0&&(j=2*n+j),s&&S>j&&(S-=2*n),!s&&j>S&&(j-=2*n)}var T=j-S;if(u(T)>p){var H=j,L=x,O=y;j=S+p*(s&&j>S?1:-1),b=z(x=m+i*t.cos(j),y=A+a*t.sin(j),i,a,o,0,s,L,O,[j,H,m,A])}T=j-S;var Q=t.cos(S),U=t.sin(S),V=t.cos(j),X=t.sin(j),Y=t.tan(T/4),P=4/3*i*Y,Z=4/3*a*Y,I=[r,e],$=[r+P*U,e-Z*Q],B=[x+P*X,y-Z*V],D=[x,y];if($[0]=2*I[0]-$[0],$[1]=2*I[1]-$[1],l)return[$,B,D].concat(b);for(var E=[],G=0,J=(b=[$,B,D].concat(b).join().split(",")).length;G<J;G++)E[G]=G%2?d(b[G-1],b[G],g).y:d(b[G],b[G+1],g).x;return E}function T(r){var t=l(r);if(t.curve)return p(t.curve);for(var n=m(r),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=function(r,e,t){var n,i;if(!r)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(r[0]in{T:1,Q:1})&&(e.qx=e.qy=null),r[0]){case"M":e.X=r[1],e.Y=r[2];break;case"A":r=["C",...z(e.x,e.y,...r.slice(1))];break;case"S":"C"==t||"S"==t?(n=2*e.x-e.bx,i=2*e.y-e.by):(n=e.x,i=e.y),r=["C",n,i,...r.slice(1)];break;case"T":"Q"==t||"T"==t?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),r=["C",...j(e.x,e.y,e.qx,e.qy,r[1],r[2])];break;case"Q":e.qx=r[1],e.qy=r[2],r=["C",...j(e.x,e.y,r[1],r[2],r[3],r[4])];break;case"L":r=["C",...S(e.x,e.y,r[1],r[2])];break;case"H":r=["C",...S(e.x,e.y,r[1],e.y)];break;case"V":r=["C",...S(e.x,e.y,e.x,r[1])];break;case"Z":r=["C",...S(e.x,e.y,e.X,e.Y)]}return r},o=function(r,e){if(r[e].length>7){r[e].shift();for(var t=r[e];t.length;)u[e]="A",r.splice(e++,0,["C",...t.splice(0,6)]);r.splice(e,1),f=n.length}},u=[],c="",s="",x=0,f=n.length;x<f;x++){n[x]&&(c=n[x][0]),"C"!=c&&(u[x]=c,x&&(s=u[x-1])),n[x]=a(n[x],i,s),"A"!=u[x]&&"C"==c&&(u[x]="C"),o(n,x);var y=n[x],h=y.length;i.x=y[h-2],i.y=y[h-1],i.bx=e(y[h-4])||i.x,i.by=e(y[h-3])||i.y}return t.curve=p(n),n}export{M as f};
