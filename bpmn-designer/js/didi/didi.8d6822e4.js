const n=/^class[ {]/;function t(n){return Array.isArray(n)}function e(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function r(...n){1===n.length&&t(n[0])&&(n=n[0]);const e=(n=[...n]).pop();return e.$inject=n,e}const i=/constructor\s*[^(]*\(\s*([^)]*)\)/m,o=/^(?:async\s+)?(?:function\s*[^(]*)?(?:\(\s*([^)]*)\)|(\w+))/m,c=/\/\*([^*]*)\*\//m;function u(t){if("function"!=typeof t)throw new Error(`Cannot annotate "${t}". Expected a function!`);const e=t.toString().match(function(t){return n.test(t.toString())}(t)?i:o);if(!e)return[];const r=e[1]||e[2];return r&&r.split(",").map((n=>{const t=n.match(c);return(t&&t[1]||n).trim()}))||[]}function s(n,i){const o=i||{get:function(n,t){if(c.push(n),!1===t)return null;throw l(`No provider for "${n}"!`)}},c=[],a=this._providers=Object.create(o._providers||null),p=this._instances=Object.create(null),_=p.injector=this,l=function(n){const t=c.join(" -> ");return c.length=0,new Error(t?`${n} (Resolving: ${t})`:n)};function h(n,t){if(!a[n]&&n.includes(".")){const t=n.split(".");let e=h(t.shift());for(;t.length;)e=e[t.shift()];return e}if(e(p,n))return p[n];if(e(a,n)){if(-1!==c.indexOf(n))throw c.push(n),l("Cannot resolve circular dependency!");return c.push(n),p[n]=a[n][0](a[n][1]),c.pop(),p[n]}return o.get(n,t)}function d(n,i){if(void 0===i&&(i={}),"function"!=typeof n){if(!t(n))throw l(`Cannot invoke "${n}". Expected a function!`);n=r(n.slice())}return{fn:n,dependencies:(n.$inject||u(n)).map((n=>e(i,n)?i[n]:h(n)))}}function v(n){const{fn:t,dependencies:e}=d(n);return new(Function.prototype.bind.call(t,null,...e))}function y(n,t,e){const{fn:r,dependencies:i}=d(n,e);return r.apply(t,i)}function O(n){return r((t=>n.get(t)))}function g(n,t){if(t&&t.length){const e=Object.create(null),r=Object.create(null),i=[],o=[],c=[];let u,s,f,p;for(let n in a)u=a[n],-1!==t.indexOf(n)&&("private"===u[2]?(s=i.indexOf(u[3]),-1===s?(f=u[3].createChild([],t),p=O(f),i.push(u[3]),o.push(f),c.push(p),e[n]=[p,n,"private",f]):e[n]=[c[s],n,"private",o[s]]):e[n]=[u[2],u[1]],r[n]=!0),"factory"!==u[2]&&"type"!==u[2]||!u[1].$scope||t.forEach((t=>{-1!==u[1].$scope.indexOf(t)&&(e[n]=[u[2],u[1]],r[t]=!0)}));t.forEach((n=>{if(!r[n])throw new Error('No provider for "'+n+'". Cannot use provider from the parent!')})),n.unshift(e)}return new s(n,_)}const j={factory:y,type:v,value:function(n){return n}};function m(n,t){const e=n.__init__||[];return function(){e.forEach((n=>{"string"==typeof n?t.get(n):t.invoke(n)}))}}function w(n){const t=n.__exports__;if(t){const e=n.__modules__,i=Object.keys(n).reduce(((t,e)=>("__exports__"!==e&&"__modules__"!==e&&"__init__"!==e&&"__depends__"!==e&&(t[e]=n[e]),t)),Object.create(null)),o=g((e||[]).concat(i)),c=r((function(n){return o.get(n)}));t.forEach((function(n){a[n]=[c,n,"private",o]}));const u=(n.__init__||[]).slice();return u.unshift((function(){o.init()})),m(n=Object.assign({},n,{__init__:u}),o)}return Object.keys(n).forEach((function(t){if("__init__"===t||"__depends__"===t)return;const e=n[t];if("private"===e[2])return void(a[t]=e);const r=e[0],i=e[1];a[t]=[j[r],f(r,i),r]})),m(n,_)}function x(n,t){return-1!==n.indexOf(t)||-1!==(n=(t.__depends__||[]).reduce(x,n)).indexOf(t)?n:n.concat(t)}this.get=h,this.invoke=y,this.instantiate=v,this.createChild=g,this.init=function(n){const t=n.reduce(x,[]).map(w);let e=!1;return function(){e||(e=!0,t.forEach((n=>n())))}}(n)}function f(n,e){return"value"!==n&&t(e)&&(e=r(e.slice())),e}export{s as I};
