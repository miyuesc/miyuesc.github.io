const n=/^class[ {]/;function t(n){return Array.isArray(n)}function e(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function r(...n){1===n.length&&t(n[0])&&(n=n[0]);const e=(n=[...n]).pop();return e.$inject=n,e}const i=/constructor\s*[^(]*\(\s*([^)]*)\)/m,o=/^(?:async\s+)?(?:function\s*[^(]*)?(?:\(\s*([^)]*)\)|(\w+))/m,c=/\/\*([^*]*)\*\//m;function u(t){if("function"!=typeof t)throw new Error(`Cannot annotate "${t}". Expected a function!`);const e=t.toString().match(function(t){return n.test(t.toString())}(t)?i:o);if(!e)return[];const r=e[1]||e[2];return r&&r.split(",").map((n=>{const t=n.match(c);return(t&&t[1]||n).trim()}))||[]}function s(n,i){i=i||{get:function(n,t){if(o.push(n),!1===t)return null;throw _(`No provider for "${n}"!`)}};const o=[],c=this._providers=Object.create(i._providers||null),p=this._instances=Object.create(null),a=p.injector=this,_=function(n){const t=o.join(" -> ");return o.length=0,new Error(t?`${n} (Resolving: ${t})`:n)};function l(n,t){if(!c[n]&&-1!==n.indexOf(".")){const t=n.split(".");let e=l(t.shift());for(;t.length;)e=e[t.shift()];return e}if(e(p,n))return p[n];if(e(c,n)){if(-1!==o.indexOf(n))throw o.push(n),_("Cannot resolve circular dependency!");return o.push(n),p[n]=c[n][0](c[n][1]),o.pop(),p[n]}return i.get(n,t)}function h(n,i){if(void 0===i&&(i={}),"function"!=typeof n){if(!t(n))throw _(`Cannot invoke "${n}". Expected a function!`);n=r(n.slice())}return{fn:n,dependencies:(n.$inject||u(n)).map((n=>e(i,n)?i[n]:l(n)))}}function d(n){const{fn:t,dependencies:e}=h(n);return new(Function.prototype.bind.apply(t,[null].concat(e)))}function v(n,t,e){const{fn:r,dependencies:i}=h(n,e);return r.apply(t,i)}function y(n){return r((t=>n.get(t)))}function O(n,t){if(t&&t.length){const e=Object.create(null),r=Object.create(null),i=[],o=[],u=[];let s,f,p,a;for(let n in c)s=c[n],-1!==t.indexOf(n)&&("private"===s[2]?(f=i.indexOf(s[3]),-1===f?(p=s[3].createChild([],t),a=y(p),i.push(s[3]),o.push(p),u.push(a),e[n]=[a,n,"private",p]):e[n]=[u[f],n,"private",o[f]]):e[n]=[s[2],s[1]],r[n]=!0),"factory"!==s[2]&&"type"!==s[2]||!s[1].$scope||t.forEach((t=>{-1!==s[1].$scope.indexOf(t)&&(e[n]=[s[2],s[1]],r[t]=!0)}));t.forEach((n=>{if(!r[n])throw new Error('No provider for "'+n+'". Cannot use provider from the parent!')})),n.unshift(e)}return new s(n,a)}const g={factory:v,type:d,value:function(n){return n}};function j(n,t){const e=n.__init__||[];return function(){e.forEach((n=>{"string"==typeof n?t.get(n):t.invoke(n)}))}}function m(n){const t=n.__exports__;if(t){const e=n.__modules__,i=Object.keys(n).reduce(((t,e)=>("__exports__"!==e&&"__modules__"!==e&&"__init__"!==e&&"__depends__"!==e&&(t[e]=n[e]),t)),Object.create(null)),o=O((e||[]).concat(i)),u=r((function(n){return o.get(n)}));t.forEach((function(n){c[n]=[u,n,"private",o]}));const s=(n.__init__||[]).slice();return s.unshift((function(){o.init()})),j(n=Object.assign({},n,{__init__:s}),o)}return Object.keys(n).forEach((function(t){if("__init__"===t||"__depends__"===t)return;if("private"===n[t][2])return void(c[t]=n[t]);const e=n[t][0],r=n[t][1];c[t]=[g[e],f(e,r),e]})),j(n,a)}function w(n,t){return-1!==n.indexOf(t)||-1!==(n=(t.__depends__||[]).reduce(w,n)).indexOf(t)?n:n.concat(t)}this.get=l,this.invoke=v,this.instantiate=d,this.createChild=O,this.init=function(n){const t=n.reduce(w,[]).map(m);let e=!1;return function(){e||(e=!0,t.forEach((n=>n())))}}(n)}function f(n,e){return"value"!==n&&t(e)&&(e=r(e.slice())),e}export{s as I};
